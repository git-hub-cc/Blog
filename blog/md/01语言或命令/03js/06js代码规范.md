好的，这是一个对 Google JavaScript Style Guide 的完整内容分类输出文档。

本文档旨在对 Google JavaScript 风格指南进行系统性的分类和总结，帮助开发者快速理解和应用其中的核心规范。它将指南的内容划分为几个关键领域，并对每个领域下的重要规则进行详细阐述。

---

## Google JavaScript 风格指南 (Style Guide) 分类详解

### 摘要

Google JavaScript 风格指南是 Google 内部用于编写高质量、可维护、一致性强的 JavaScript 代码的官方标准。它不仅关注代码的格式化，还涵盖了语言特性的使用、命名约定、文档注释和最佳实践。遵循该指南可以显著提升团队协作效率和项目代码的健壮性。

### 官方文档链接

- **英文原版:** [Google JavaScript Style Guide](https://google.github.io/styleguide/jsguide.html)
- **中文翻译版 (参考):** [Google JavaScript Style Guide 中文版](https://github.com/google/styleguide/blob/gh-pages/jsguide.md)

---

### 一、 文件结构与源码格式 (File Structure & Source Format)

这类规范定义了源文件的基本结构和格式，是代码组织的起点。

1.  **文件名 (File Name)**
    *   **规则:** 文件名应全部小写，可以包含下划线 (`_`) 或短横线 (`-`)，但下划线是首选。
    *   **示例:** `my_useful_script.js`, `api_client.js`

2.  **文件编码 (File Encoding)**
    *   **规则:** 所有源文件必须使用 `UTF-8` 编码。

3.  **源文件结构 (Source File Structure)**
    *   **规则:** 一个源文件应按以下顺序组织：
        1.  **版权和许可证信息 (可选)**: 如果需要，放在文件顶部。
        2.  **`@fileoverview` JSDoc**: 一个对文件内容的高级描述。
        3.  **`goog.module` 或 ES 模块 (`import`/`export`)**: 模块声明和依赖导入。
        4.  **文件实现代码**: 文件的核心逻辑。

    *   **示例 (ES 模块):**
        ```javascript
        /**
         * @fileoverview Description of this file.
         */

        import {someSymbol} from './some_module.js';

        // ... implementation code
        ```

### 二、 格式化 (Formatting)

格式化规范关注代码的视觉表现，旨在提升可读性。

1.  **花括号 (Braces)**
    *   **规则:** 始终使用花括号 `{}` 包裹 `if`, `else`, `for`, `do`, `while` 等语句块，即使只有一行代码。
    *   **风格:** 遵循 K&R 风格，即左花括号 `{` 不另起一行。
    *   **示例:**
        ```javascript
        // 正确
        if (condition) {
          doSomething();
        }

        // 错误
        if (condition) doSomething();
        ```

2.  **缩进 (Indentation)**
    *   **规则:** 每次缩进使用 **2个空格**，禁止使用 Tab。

3.  **行长度 (Line Length)**
    *   **规则:** 每行代码长度建议不超过 **80 或 100 个字符**。这通常由项目配置决定。

4.  **换行 (Line Wrapping)**
    *   **规则:** 当代码行超长时，应进行换行。
    *   **策略:**
        *   在操作符（如 `+`, `.`, `,`）**之后**换行。
        *   换行后的新行缩进层级通常是 **+4 个空格**。
        *   对于方法链式调用，每个调用另起一行，并以 `.` 开头。
    *   **示例:**
        ```javascript
        const result = someLongVariableName1 + someLongVariableName2 +
            someLongVariableName3;

        const data = someObject.firstMethod()
            .secondMethod({
              config: 'value',
            })
            .thirdMethod();
        ```

5.  **空白 (Whitespace)**
    *   **垂直空白:** 使用空行来分隔逻辑相关的代码块。
    *   **水平空白:**
        *   在所有二元和三元操作符（`+`, `-`, `*`, `/`, `=`, `==`, `===`, `?`, `:` 等）两边加空格。
        *   在逗号 `,`、分号 `;` 和花括号 `{` 的左边加空格（如果适用）。
        *   在 `for` 语句的 `;` 后加空格。
        *   在 `for`, `while`, `if`, `switch` 等关键字后的小括号 `(` 前加空格。

### 三、 语言特性 (Language Features)

这部分是指南的核心，规定了如何正确、高效地使用 JavaScript 语言特性。

1.  **变量声明 (Variable Declarations)**
    *   **规则:**
        *   **禁止使用 `var`。**
        *   默认使用 `const` 声明所有引用，除非变量需要被重新赋值。
        *   当变量需要被重新赋值时，使用 `let`。
        *   每个声明只声明一个变量。

2.  **数组 (Arrays)**
    *   **规则:**
        *   使用字面量 `[]` 创建数组，而不是 `new Array()`。
        *   允许使用尾后逗号，便于增删元素和版本控制。
        *   优先使用数组解构和扩展运算符 (`...`)。

3.  **对象 (Objects)**
    *   **规则:**
        *   使用字面量 `{}` 创建对象，而不是 `new Object()`。
        *   使用方法简写和属性值简写。
        *   只有在属性名是无效标识符时才使用引号。
    *   **示例:**
        ```javascript
        const name = 'Alice';
        const user = {
          name, // 属性值简写
          sayHi() { // 方法简写
            console.log('Hi');
          },
          'invalid-property': 'value', // 无效标识符使用引号
        };
        ```

4.  **字符串 (Strings)**
    *   **规则:**
        *   优先使用**单引号 `'`** 而不是双引号 `"`。
        *   当字符串需要拼接变量或包含换行时，使用**模板字符串 `` ` ``**。
        *   长字符串应通过 `+` 或模板字符串进行换行拼接。

5.  **函数 (Functions)**
    *   **规则:**
        *   优先使用函数声明语句，而不是函数表达式。
        *   **箭头函数 (`=>`)** 的使用：
            *   适用于无 `this` 绑定的简单函数（如回调）。
            *   当需要保留词法作用域的 `this` 时非常有用。
        *   使用默认参数、剩余参数 (`...`) 和扩展运算符 (`...`) 简化函数定义和调用。

6.  **类 (Classes)**
    *   **规则:**
        *   使用 `class` 关键字代替基于原型链的构造函数。
        *   `constructor` 是可选的。
        *   派生类必须在 `constructor` 中调用 `super()`。
        *   避免直接修改 `prototype`。

7.  **模块 (Modules)**
    *   **规则:**
        *   使用 ES 模块 (`import`/`export`)。
        *   `import` 路径应是相对于当前文件的相对路径 (`./`, `../`) 或绝对路径。
        *   禁止使用通配符导入 (`import * as foo from ...`)，除非确实需要整个模块对象。
        *   `import` 和 `export` 语句应位于文件的顶部。

8.  **迭代器与生成器 (Iterators and Generators)**
    *   **规则:**
        *   优先使用 `for...of` 循环遍历可迭代对象（如数组、Map、Set）。
        *   谨慎使用 `for...in`，它会遍历原型链上的属性，且通常不是你想要的结果。

9.  **其他重要规则**
    *   **相等性:** 始终使用严格相等 `===` 和 `!==`，禁止使用 `==` 和 `!=`。
    *   **`this` 关键字:** 小心 `this` 的指向问题，箭头函数是解决词法 `this` 的好方法。
    *   **真值判断 (Truthy/Falsy):** 避免隐式类型转换，在需要布尔值的地方进行显式转换（如 `Boolean(x)` 或 `!!x`）。

### 四、 命名约定 (Naming Conventions)

清晰的命名是代码自解释的关键。

1.  **通用规则:** 命名应具有描述性，避免不明确的缩写。

2.  **包/模块名 (Package/Module Names)**
    *   **风格:** `lower_snake_case` (全小写+下划线)
    *   **示例:** `google_closure_library`

3.  **类/构造函数/枚举/类型定义 (Classes/Constructors/Enums/Typedefs)**
    *   **风格:** `UpperCamelCase` (大驼峰命名法)
    *   **示例:** `class ApiClient`, `class MyError`

4.  **方法/函数/普通变量 (Methods/Functions/Variables)**
    *   **风格:** `lowerCamelCase` (小驼峰命名法)
    *   **示例:** `function sendMessage()`, `let userName`

5.  **常量 (Constants)**
    *   **风格:** `CONSTANT_CASE` (全大写+下划线)
    *   **定义:** 常量是指其值在程序生命周期内永远不变的变量。通常在文件顶层或 `class` 的 `static` 属性中定义。
    *   **示例:** `const REQUEST_TIMEOUT = 5000;`

6.  **私有属性/方法 (Private Properties/Methods)**
    *   **风格:** 在名称末尾添加一个下划线 `_`。
    *   **注意:** 这只是一个约定，JavaScript 语言本身（在 `private` 字段 `#` 普及前）不提供强制的私有性。
    *   **示例:** `class MyClass { doSomething_() { ... } }`

### 五、 JSDoc 与注释 (JSDoc & Comments)

注释是为了让人读懂代码，尤其是复杂的逻辑和公共 API。

1.  **JSDoc 注释 (`/** ... */`)**
    *   **使用场景:** 所有的公共类、方法、函数和非平凡的属性都应该有 JSDoc 注释。
    *   **内容:**
        *   必须包含一段描述性文字。
        *   使用 `@param` 描述参数。
        *   使用 `@return` 描述返回值。
        *   使用 `@constructor` 标记类。
        *   使用 `@private`, `@protected` 标记访问级别。
        *   使用 `@deprecated` 标记已废弃的 API。

2.  **实现注释 (`//` 或 `/* ... */`)**
    *   **使用场景:** 用于解释代码中不明显、复杂或重要的部分。
    *   **原则:** 注释应该解释 **“为什么” (Why)**，而不是 **“是什么” (What)**。代码本身应该能解释“是什么”。

### 六、 最佳实践与注意事项 (Best Practices & Considerations)

这部分涵盖了一些宏观原则和需要规避的陷阱。

1.  **避免全局变量 (Avoid Global Variables)**
    *   **原因:** 全局变量会污染命名空间，导致命名冲突和难以追踪的 Bug。
    *   **解决方案:** 使用 ES 模块将代码封装起来。

2.  **避免使用 `eval()` 和 `with`**
    *   **`eval()`:** 存在严重的安全风险和性能问题。
    *   **`with`:** 已被废弃，会产生令人困惑的作用域。

3.  **类型注解 (Type Annotations)**
    *   **背景:** Google 内部大量使用 Closure Compiler 进行类型检查和代码优化。
    *   **规则:** 鼓励使用 JSDoc 的类型注解（如 `@param {string} userName`），即使不使用 Closure Compiler，这些注解也能极大地增强代码的可读性和可维护性。

4.  **错误处理 (Error Handling)**
    *   **规则:** 优先使用 `Error` 对象或其子类来表示错误，而不是简单的字符串。

---

### 总结

Google JavaScript 风格指南是一个全面而实用的规范集合。它的核心目标可以概括为：

*   **一致性 (Consistency):** 让所有开发者像同一个人一样编写代码。
*   **可读性 (Readability):** 代码首先是写给人看的，其次才是给机器执行的。
*   **可维护性 (Maintainability):** 结构清晰、文档完善的代码更容易修改和扩展。

通过将这些规范应用到日常开发中，并借助 ESLint、Prettier 等自动化工具（可以配置它们来遵循 Google 风格），可以显著提升个人和团队的编码水平。