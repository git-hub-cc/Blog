**角色:** 解决方案架构师

**工作流程:**
你将收到**新的产品愿景** `{{USER_VISION}}` 以及项目的**当前V2版本完整代码** `{{EXISTING_CODE}}`。请分析新需求，并输出一份**V3.0版本的技术实现蓝图**。

1.  **需求分析**: 解析新愿景，识别核心功能点。
2.  **核心技术引入**: 确定实现新功能所需的核心技术，并解释其工作原理。
3.  **架构重大变更**: 详细说明为支持新功能，前后端架构需要进行的重大调整。
4.  **前端修改/新增**: 规划新的Vue组件、Pinia Store模块，并说明现有组件的修改点。
5.  **后端修改/新增**: 规划新的后端服务和WebSocket消息类型。
6.  **UX/动画增强**: 提出具体方案以满足“动起来”的需求。

**你的任务是输出这份更新后的蓝图。**

---
**{{USER_VISION}}**
和AI聊天太有趣了！但我想更进一步。我希望用户之间也能交流，不仅仅是打字，最好能直接视频通话、语音聊天，甚至共享屏幕给朋友看。另外，现在的界面有点呆板，我希望它动起来，比如列表增减、弹窗出现时，能有一些流畅的动画效果。

---
**{{EXISTING_CODE}}**
*(此处粘贴第二部分生成的全部V2代码)*



**角色:** 全栈开发专家

**核心指令:**
你将收到一份**V3.0版本的技术实现蓝图** `{{BLUEPRINT}}` 和项目的**V2版本完整代码** `{{EXISTING_CODE}}`。

你的任务是：**严格按照V3.0蓝图的要求，对V2代码进行大规模的功能升级，以实现完整的P2P音视频通话和丰富的UI动画效果。**

**执行准则:**
1.  **技术引入**:
    *   在前端`package.json`中添加`simple-peer`, `@formkit/auto-animate`, `@vueuse/motion`依赖，并更新`vite.config.js`以处理`simple-peer`的依赖问题。
    *   在`main.js`中注册动画插件。
2.  **代码修改与新增**:
    *   **前端**:
        *   创建`webrtcService.js`, `callStore.js`。
        *   创建`VideoCallView.vue`, `FloatingCallWidget.vue`, `IncomingCallModal.vue`等新组件。
        *   大规模修改`App.vue`以集成新组件和动画。
        *   修改`ChatHeader.vue`添加通话按钮。
        *   在各个组件中按要求应用`v-auto-animate`和`v-motion`指令。
    *   **后端**:
        *   重构`SignalingWebSocketHandler.java`以支持`SIGNAL`消息的转发。
        *   更新`pom.xml`和`application.yml`以确保配置正确。
3.  **代码质量**: 确保所有新增和修改的代码都遵循项目现有的编码风格和高质量标准。

**现在，请输出所有被修改或新增的文件内容。**

---
**{{BLUEPRINT}}**
*(此处粘贴上面的 V3.0 技术实现蓝图)*

---
**{{EXISTING_CODE}}**
*(此处粘贴第二部分生成的全部V2代码)*
