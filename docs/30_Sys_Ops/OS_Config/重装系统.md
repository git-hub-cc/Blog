# Windows 系统重置与优化指南 🛠️

本指南旨在为您提供一个清晰、高效的 Windows 系统重置与重装流程，从准备工作到软件自动化部署，助您快速恢复生产力。

---

## 1. 原则与核心理念
在进行系统操作时，建议遵循以下优先级：
*   **自己开发的软件** > **包管理工具 (Scoop)** > **官网下载安装**
*   **保持纯净**：尽量减少手动干预，利用自动化工具管理环境。

---

## 2. 准备阶段 (备份清单) 💾
在重置系统前，请务必检查以下内容：
- [ ] **软件安装包**：可提前下载常用庞大的离线安装包。
- [ ] **账号信息**：各类软件账号、系统登录账号。
- [ ] **核心资料**：
    - 项目源代码、笔记文件 (Markdown/Notion 等)。
    - **库文件**：Documents, Pictures, Videos 等目录。
    - **配置文件**：SSH 密钥 (.ssh)、各种软件的配置文件 (AppData)。
    - **桌面文件**：确认桌面无未保存的临时资料。

---

## 3. 系统选择与安装建议 💿
### 方案建议
1.  **首选重置**：尝试系统自带的“重置此电脑”功能。
2.  **大版本升级/彻底重刷**：
    - 官方工具：[Windows 10 下载](https://www.microsoft.com/zh-cn/software-download/windows10) | [Windows 11 下载](https://www.microsoft.com/zh-cn/software-download/windows11)
    - 传统途径：[MSDN, I Tell You](https://msdn.itellyou.cn/)

### 系统对比参考
*   **Windows 10/11**：现代办公首选，建议使用 U 盘制作纯净安装盘，Docker 建议在 Windows 下通过**虚拟机 VMware** 使用。
*   **Deepin**：应用商店成熟，但系统预装内容较多，略显臃肿。
*   **Ubuntu**：Docker 环境极佳，但由于输入法和软件管理问题

> [!TIP]
> 建议将内存升级至 **32GB**，以获得更流畅的容器化开发体验。

---

## 4. 安装后的初始配置 ⚙️
1.  **基础设置**：登录微软账号以同步激活信息。
2.  **系统清道夫**：删除系统自带且不常用的冗余软件。
3.  **精简服务**：在控制面板中关闭不必要的后台服务。
4.  **关闭更新**：如有需要，可通过策略组或工具暂时关闭强制性的系统更新。
5.  **驱动安装**：首要安装 **AMD (CPU/GPU)** 驱动，确保系统性能最大化。

---

## 5. 软件自动化部署 (Scoop) 🚀
使用 [Scoop](https://scoop.sh/) 管理软件，可以保持系统的干净整洁。

### 5.1 安装 Scoop
请在 **PowerShell** (非管理员权限) 中运行：
```powershell
# 设置执行策略
Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser

# 下载并运行安装脚本
irm get.scoop.sh -outfile 'install.ps1'
.\install.ps1
```

### 5.2 常用软件一键安装
```powershell
# 1. 基础工具
scoop install 7zip git

# 2. 添加国内镜像库 (推荐)
scoop bucket add scoop-proxy-cn https://github.com/lzwme/scoop-proxy-cn

# 3. 添加常用软件库
scoop bucket add Extras

# 4. 安装生产力与工具
scoop install wps motrix evcapture

# 5. 开发环境
scoop install nodejs24 python310
```

---

## 6. 开发工具集锦 (IDE & Editor) 💻
*   **Antigravity**：
    - 必装插件：`Chinese (Simplified)`, `Markdown All in One`。
*   **浏览器**：
    - 推荐使用系统自带的 **Edge**，但务必清理首页和关闭非必要功能以释放内存。

---


在 Windows PowerShell 中永久设置编码为 **UTF-8 (65001)**



### 1. 检查并创建配置文件

在 PowerShell 中运行以下命令，查看你的配置文件脚本是否存在：

```powershell
if (!(Test-Path -Path $PROFILE)) { New-Item -ItemType File -Path $PROFILE -Force }

```

### 2. 编辑配置文件

使用记事本打开该文件：

```powershell
notepad $PROFILE

```

### 3. 添加 UTF-8 强制指令

在打开的记事本中，将以下三行代码粘贴进去并保存：

```powershell
$OutputEncoding = [Console]::OutputEncoding = [System.Text.Encoding]::UTF8
[Console]::InputEncoding = [System.Text.Encoding]::UTF8
$PSDefaultParameterValues['Out-File:Encoding'] = 'utf8'

```

*这几行代码分别确保了：**输出流**、**控制台显示**以及**文件读取**都默认使用 UTF-8。*

### 4. 激活配置

关闭并重新打开 PowerShell，或者直接执行以下命令使其立即生效：

```powershell
. $PROFILE

```

> [!NOTE]
> 维护此文档是为了在每次面对崭新的系统时，都能在 30 分钟内恢复至最舒适的工作状态。

使用镜像服务
```
npm config set registry https://registry.npmmirror.com

pip config set global.index-url https://mirrors.aliyun.com/pypi/simple/

[Environment]::SetEnvironmentVariable("ELECTRON_MIRROR", "https://npmmirror.com/mirrors/electron/", "User")
[Environment]::SetEnvironmentVariable("ELECTRON_CUSTOM_DIR", "{{ version }}", "User")
```


### 终极方案：Windows 10 版本 1909 (OS 内部版本 18363.592)

在正常系统状态下，你是无法修改 Defender 核心服务的（系统会提示“拒绝访问”）。我们必须进入安全模式来绕过限制。

**第一步：关闭防篡改（关键前置）**

1. 尽管任务栏没有图标，你依然需要通过 **开始菜单** -> **设置** -> **更新和安全** -> **Windows 安全中心** 进入。
2. 找到 **病毒和威胁防护** -> **管理设置**。
3. 务必将 **篡改防护（Tamper Protection）** 关闭。如果不关，重启后一切修改都会被系统自动复原。

**第二步：进入 Windows 安全模式**

1. 按 `Win + R` 键，输入 `msconfig` 并回车。
2. 切换到 **引导** 选项卡。
3. 勾选 **安全引导**，选择默认的 **最小**。
4. 点击确定，然后选择 **重新启动**。电脑将黑屏启动进入安全模式。

**第三步：通过注册表硬核禁用服务**
进入安全模式后，此时 Defender 的自我保护机制是失效的。

1. 按 `Win + R`，输入 `regedit` 回车，打开注册表编辑器。
2. 导航到以下路径：
`HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\WinDefend`
*(这是 Defender 的主服务)*
3. 在右侧找到名为 `Start` 的项，双击它，将数值数据从 `2`（自动）修改为 `4`（禁用），点击确定。
4. 接着，导航到另一个路径：
`HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\WdNisSvc`
*(这就是导致你 CPU 占用的 Antimalware Service Executable 网络检查服务)*
5. 同样找到 `Start` 项，双击将数值修改为 `4`，点击确定。

**第四步：退出安全模式并重启**

1. 再次按 `Win + R`，输入 `msconfig` 回车。
2. 在 **引导** 选项卡中，**取消勾选** “安全引导”。
3. 点击确定，重启电脑。
